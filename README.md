<h1>writers-app</h1>

<h2>Задание</h2>

Реализовать сервис, который хранит в PostgreSQL данные о писателях и их книгах, и способен по HTTP-запросу <b>GET /writers/&lt;writer_id></b> возвращать информацию о писателе и его книгах в формате JSON.

<h2>Требования</h2>

<ol>
    <li>Сервис должен иметь поддержку запуска из консоли с параметром командной строки <i>init</i>, который создает в базе данных нужные таблицы, и заполняет их тестовыми данными (пара-тройка писателей и их книг).</li>
    <li>Метод получения данных о писателе по HTTP-запросу <u>не должен обращаться к базе данных более одного раза</u>.</li>
    <li>Наличие которого README.md с инструкцией по инициализации базы данных и по запуску сервиса.</li>
</ol>

<h2>Модели данных</h2>

<h3>Писатели (writers)</h3>

<table>
    <tr>
        <td>id</td>
        <td>идентификатор</td>
    </tr>
    <tr>
        <td>name</td>
        <td>имя</td>
    </tr>
</table>

<h3>Книги (books)</h3>

<table>
    <tr>
        <td>id</td>
        <td>идентификатор</td>
    </tr>
    <tr>
        <td>author_id</td>
        <td>идентификатор автора</td>
    </tr>
    <tr>
        <td>title</td>
        <td>название</td>
    </tr>
</table>

<h2>Реализация</h2>

Разработанный сервис реализован на основе трехзвенной архитектуры и включает в себя следующие составляющие:
<ol>
    <li><b>Клиент</b> (writers.py)</li>
    <li><b>Сервер</b> (app.py)</li>
    <li><b>База данных</b> (writers)</li>
</ol>

<h2>Развертывание</h2>

Для развертывания базы данных и сервера воспользуйтесь следующей инструкцией:
<ol>
    <li>Создайте базу данных <i>writers</i>. В терминале Linux вы можете сделать это посредством применения следующих команд:
        <ul>
            <li><b>sudo -i -u &lt;username></b>, где <i>username</i> - имя пользователя (по умолчанию <i>postgres</i>).</li>
            <li><b>createdb writers</b></li>
        </ul>
    </li>
    <li>В папке с сервером создайте файл переменных окружения .env (<b>touch .env</b>). В созданном файле создайте переменную <b>DATABASE_URL</b>, имеющую в качестве своего значения ссылку на базу данных. (По умолчанию для локальной сети <i>DATABASE_URL=postgresql://postgres:postgres@localhost/writers</i>)</li>
    <li>Установите необходимые зависимости (<b>pip install -r requirements.txt</b>) для сервера.</li>
    <li>Запустите серверное приложение (<b>python3 app.py</b>).</li>
</ol>

<h2>Использование</h2>

Для использование сервиса выполните следующие шаги:
<ol>
    <li>Перед первым запуском клиентского приложения в папке с приложением создайте файл переменных окружения .env (<b>touch .env</b>). В созданном файле создайте переменную <b>HOST_URL</b>, имеющую в качестве своего значения ссылку на сервер. (По умолчанию для локальной сети <i>HOST_URL=http://localhost:5000</i>)</li>
    <li>Запустите клиентское приложение (<b>python3 writers.py</b>) с одним из следующих параметров командной строки:
        <ul>
            <li><b>-i (--init)</b> - для создания необходимых таблиц в базе данных.</li>
            <li><b>-s (--show)</b> - для получения данных об идентификаторах писателей.</li>
            <li><b>-w (--writer) &lt;writer_id></b> - для получения данных о выбранном писателе по его идентификатору.</li>
        </ul>
    </li>
</ol>

<h2>Пример работы программы</h2>

1. Создание таблиц (<b>python3 writers.py -i<b>):

> Tables 'writers' and 'books' has been initialized.

2. Получение данных об идентификаторах писателей (<b>python3 writers.py -s</b>):


```python
[
    {
        "id": 1,
        "name": "Достоевский, Ф.М."
    },
    {
        "id": 2,
        "name": "Булгаков, М.А."
    },
    {
        "id": 3,
        "name": "Куприн, А.И."
    }
]
```




    [{'id': 1, 'name': 'Достоевский, Ф.М.'},
     {'id': 2, 'name': 'Булгаков, М.А.'},
     {'id': 3, 'name': 'Куприн, А.И.'}]



3. Получение данных о трудах Достоевского (<b>python3 writers.py -w 1</b>):


```python
{
    "id": 1,
    "name": "Достоевский, Ф.М.",
    "books": [
        {
            "id": 2,
            "title": "Преступление и наказание"
        },
        {
            "id": 3,
            "title": "Игрок"
        },
        {
            "id": 7,
            "title": "Братья Карамазовы"
        },
        {
            "id": 8,
            "title": "Идиот"
        }
    ]
}
```




    {'id': 1,
     'name': 'Достоевский, Ф.М.',
     'books': [{'id': 2, 'title': 'Преступление и наказание'},
      {'id': 3, 'title': 'Игрок'},
      {'id': 7, 'title': 'Братья Карамазовы'},
      {'id': 8, 'title': 'Идиот'}]}


